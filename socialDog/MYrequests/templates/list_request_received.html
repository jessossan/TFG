{% extends 'base/base.html' %}
{% block title %}
Solicitudes
{% endblock %}
{% block content %}

<div class="container-fluid">
<h3 >Solicitudes</h3>

<div align="left" >
    {% if isSent %}
        <input type="button"  class="btn editbutton"
                               onclick="location.href='/requests/listReceived';"
                               value="Solicitudes recibidas"/>&nbsp
        <input type="button"  class="btn pulsado" style="border-color:#2c539e"
                               onclick="location.href='/requests/listSent';"
                               value="Solicitudes enviadas"/>&nbsp

    {% else %}
        <input type="button"  class="btn pulsado" style="border-color:#2c539e"
                               onclick="location.href='/requests/listReceived';"
                               value="Solicitudes recibidas"/>&nbsp
        <input type="button"  class="btn editbutton"
                               onclick="location.href=location.href='/requests/listSent';"
                               value="Solicitudes enviadas"/>&nbsp

    {% endif %}
</div>
        </br>

        <!-- Listado -->
        {% if request_list %}
        <div class="panel panel-default panel-table mb-3">
          <div class="panel-heading">
          </div>
          <div class="panel-body">
            <table class="table table-striped table-curved table-hover table-bordered">


                    <thead class="thead-primary">
                    <tr>
                        <th>Nombre</th>
                        <th>Descripci√≥n</th>
                        <!-- Si esta pendiente: Aceptar/Denegar-->
                        <th>Estado</th>
                        <!-- Ver perfil-->
                        <th></th>
                        <!--Borrar-->
                        <th></th>
                    </tr>
                  </thead>

                    <tbody>
                    {% for request in request_list %}
                        <tr>
                            <td>{{ request.follower.userAccount.first_name }}  {{ request.follower.userAccount.last_name }}</td>
                            <td>{{ request.description }}</td>
                            <td>
                                {% if request.status == 'Pendiente' %}
                                    <a href="{% url 'accept_request' request.pk %}">Aceptar</a>
                                    <a href="{% url 'reject_request' request.pk %}">Denegar</a>
                                {% elif request.status == 'Aceptada' %}
                                    <i class="fa fa-check" style="color:green;font-size:30px;"></i>
                                {% else %}
                                    <i class="fa fa-close" style="color:red;font-size:30px;"></i>
                                {% endif %}
                            </td>
                            <td>
                                {% if not request.follower.customer %}
                                    <button class="btn btn-info" onclick="location.href='/actors/profile/{{ request.follower.pk }}';">
                                            <span class="fa fa-user"></span>
                                        </button>
                                {% endif %}
                            </td>
                            <td>
                                <a class="btn btn-danger" href="{% url 'delete_request_received' request.pk %}">
                                    <i class="fa fa-trash"></i>
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>

            </table>
          </div>

          <!-- PAGINACION -->
            {% if request_list.has_other_pages %}
                <div class="table-footer">
                    <div  align="center" class="pagination" style="padding:0 20px 0">
                        <ul>
                            {% if request_list.has_previous %}
                            <li class="previous"><a href="?page={{ request_list.previous_page_number }}" class="fa fa-arrow-left"></a></li>
                            {% else %}
                            <li class="previous disabled"><a href="#" class="fa fa-arrow-left"></a></li>
                            {% endif %}
                            {% for i in request_list.paginator.page_range %}
                                {% if request_list.number == i %}
                                <li class="active"><a href="#">{{ i }}</a></li>
                                {% else %}
                                <li><a href="?page={{ i }}">{{ i }}</a></li>
                                {% endif %}
                            {% endfor %}
                            {% if request_list.has_next %}
                            <li class="next"><a href="?page={{ request_list.next_page_number }}" class="fa fa-arrow-right"></a></li>
                            {% else %}
                            <li class="previous disabled"><a href="#" class="fa fa-arrow-right"></a></li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            {% endif %}

        {% else %}
            <p >No has recibido peticiones.</p>
        {% endif %}
<br/>
        <div class="create" >
            <input type="button" class="btn editbutton"
                               onclick="location.href='/requests/create';"
                               value="Crear solicitud"/>
        </div>

    </div>
</div>
{% endblock %}
